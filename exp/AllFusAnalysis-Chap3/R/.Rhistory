colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
plot(p4)
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 10, height = 20)
p_nodes
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) # colour the fo node
geom_tiplab(aes(label = full_ID), offset = 0.0002) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.005)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_tiplab(aes(label = full_ID), offset = 0.0002) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.005)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0002) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.005)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0002) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60))
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60))
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = 0.01)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001, nudge_y = -0.001)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001, nudge_y = -0.005)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001, nudge_y = -0.05)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001, nudge_y = -0.5)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.001, nudge_y = -0.2)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.0015, nudge_y = -0.25)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.0012, nudge_y = -0.25)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
# ---- Prepare the tree ---- #
# Read the phylogenetic tree from the Newick file
unrootedtree <- read.newick(tree_file, node.label='label' )
# root the tree
tree <- root(unrootedtree, outgroup = c("F._graminearum_PH-1"))
# Identify the node number of "F._graminearum_PH-1"
node_number <- which(tree$tip.label == "F._graminearum_PH-1")
# Trim the F._graminearum_PH-1 branch
m <- MRCA(tree, 48)
tree_with_group <- groupClade(tree, m)
# ---- Build tree skeleton ---- #
p <- ggtree(tree, ladderize = T)  %<+% metadata
# Adjust the branch length for "F._graminearum_PH-1"
p$data[p$data$node %in% node_number, "x"] <- mean(p$data$x)
# ---- View the tree ---- #
# Useful for visualusing nodes etc
p_nodes <- p +
geom_text2(aes(label = parent), hjust = -0.1, size = 3)+ # add node names
geom_tiplab(aes(label = label), offset = 0.005) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03",
color='black') +
coord_cartesian(clip = "off") # stop names being trimmed off
# ---- Build the tree plot ---- #
p1 <- p +
xlim(0,0.045)
p2 <- p +
geom_highlight(node = 88, fill = "mistyrose") + # colour the Fs node
geom_highlight(node= 49, fill = "lemonchiffon1" ) + # colour the fo node
geom_treescale(x = 0, y = 1, width = 0.004) +
geom_tiplab(aes(label = full_ID), offset = 0.0004) +
# geom_tiplab(aes(label = isolate_code), color = "grey20", offset = 0.0045, linetype = "blank", geom = "text", align = TRUE) +
geom_tiplab(aes(label = race), color = "grey20", offset = 0.012, linetype = "blank", geom = "text", align = TRUE, hjust = 1)+
geom_tippoint(aes(shape = source), size = 2.5) +
geom_rootedge() +
theme(legend.position = "bottom" ) +
geom_cladelabel(node=node_number, label="Adjusted by: 0.03", offset = 0.008, color='black') + geom_nodelab(geom='label', aes(label=label, subset= !is.na(as.numeric(label)) & as.numeric(label)> 60), nudge_x = -0.0012, nudge_y = -0.25)
# Add extra scale so we can plot fsp with colour
p3 <- p2 + new_scale_fill()
# add race data
p4 <- gheatmap(p3, fsp_df,
offset = 0.012,
width = 0.03,
color = "grey20",
colnames = FALSE) +
scale_fill_manual(name = "Forma specialis",
values = c( "burlywood4", "grey","blue","purple","goldenrod","grey90","gold","brown", "tan","darkolivegreen3", "indianred", "tomato", "lavender", "yellow", "palegreen4", "slateblue", "steelblue", "pink", "red"), na.value = "grey") +
theme(legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 9),
legend.box = "vertical", legend.margin = margin())+
guides(shape = guide_legend(override.aes = list(size = 5)))
# plot it
plot(p4)
##save basic tree
ggsave("BasicTEFPhylo.png", width = 12, height = 20)
